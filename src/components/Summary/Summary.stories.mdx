import {ArgsTable, Canvas, Meta, Story} from '@storybook/addon-docs';
import {useArgs} from '@storybook/client-api';
import {useState} from 'react';
import {withRouter} from 'storybook-addon-react-router-v6';

import {SUBMISSION_ALLOWED} from 'components/constants';
import {LiteralDecorator} from 'story-utils/decorators';

import GenericSummary from './GenericSummary';

<Meta
  title="Private API/GenericSummary"
  component={GenericSummary}
  decorators={[LiteralDecorator, withRouter]}
  argTypes={{
    submissionAllowed: {
      options: [SUBMISSION_ALLOWED.yes, SUBMISSION_ALLOWED.noWithOverview],
      control: {
        type: 'radio',
        labels: {
          [SUBMISSION_ALLOWED.yes]: 'Yes',
          [SUBMISSION_ALLOWED.noWithOverview]: 'No, with overview',
        },
      },
    },
    showPreviousPageLink: {control: {type: 'boolean'}},
  }}
  args={{
    title: 'Generic Summary',
    summaryData: [
      {
        slug: 'uw-gegevens',
        name: 'Uw gegevens',
        data: [
          {
            name: 'Voornaam',
            value: 'John',
            component: {
              key: 'voornaam',
              type: 'textfield',
              label: 'Voornaam',
              hidden: false,
            },
          },
          {
            name: 'Achternaam',
            value: 'Doe',
            component: {
              key: 'achternaam',
              type: 'textfield',
              label: 'Achternaam',
              hidden: false,
            },
          },
          {
            name: 'Email adres',
            value: 'john@test.nl',
            component: {
              key: 'emailAdres',
              type: 'email',
              label: 'Email adres',
              hidden: false,
            },
          },
        ],
      },
      {
        slug: 'uw-partner',
        name: 'Uw partner',
        data: [
          {
            name: 'Voornaam',
            value: 'Carl',
            component: {
              key: 'voornaam2',
              type: 'textfield',
              label: 'Voornaam',
              hidden: false,
            },
          },
          {
            name: 'Achternaam',
            value: 'Doe',
            component: {
              key: 'achternaam2',
              type: 'textfield',
              label: 'Achternaam',
              hidden: false,
            },
          },
          {
            name: 'Email adres',
            value: 'carl@test.nl',
            component: {
              key: 'emailAdres2',
              type: 'email',
              label: 'Email adres',
              hidden: false,
            },
          },
        ],
      },
    ],
    showPaymentInformation: true,
    amountToPay: 54.05,
    showPreviousPageLink: true,
    privacyInformation: {
      requiresPrivacyConsent: true,
      privacyLabel: 'This is a privacy policy example.',
    },
    editStepText: 'Change',
    isLoading: false,
    isAuthenticated: true,
    errors: [],
    confirmText: 'Confirm',
    previousText: 'Previous',
    submissionAllowed: SUBMISSION_ALLOWED.yes,
  }}
  parameters={{
    docs: {
      source: {
        type: 'dynamic',
        excludeDecorators: true,
      },
    },
    actions: {
      argTypesRegex: 'onSubmit|onLogout|onPrevPage',
    },
    reactRouter: {
      routePath: '/',
    },
  }}
/>

export const Template = ({showPreviousPageLink, privacyInformation, ...args}) => {
  const [privacyPolicyAccepted, setPrivacyPolicyAccepted] = useState(false);
  return (
    <GenericSummary
      {...args}
      onPrevPage={showPreviousPageLink ? () => {} : null}
      privacyInformation={{...privacyInformation, policyAccepted: privacyPolicyAccepted}}
      onPrivacyCheckboxChange={() => setPrivacyPolicyAccepted(!privacyPolicyAccepted)}
    />
  );
};

# Generic summary component

This component is used both by the `SubmissionSummary` component and the `CosignSummary` component.

<Canvas>
  <Story name="Default">{Template.bind({})}</Story>
</Canvas>

## Props

<ArgsTable of={GenericSummary} />
