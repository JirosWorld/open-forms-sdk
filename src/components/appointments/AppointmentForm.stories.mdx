import {ArgsTable, Canvas, Meta, Story} from '@storybook/addon-docs';

import {buildForm} from 'api-mocks';
import {Layout, LayoutRow} from 'components/Layout';
import {ConfigDecorator, RouterDecorator} from 'story-utils/decorators';

import AppointmentForm from './AppointmentForm';
import {
  mockAppointmentDatesGet,
  mockAppointmentLocationsGet,
  mockAppointmentProductsGet,
  mockAppointmentTimesGet,
} from './mocks';

export const PaddedDiv = ({className, children}) => (
  <div style={{padding: '1em 0'}} className={className}>
    {children}
  </div>
);

export const LayoutDecorator = Story => {
  return (
    <Layout component={PaddedDiv}>
      <LayoutRow>
        <Story />
      </LayoutRow>
    </Layout>
  );
};

<Meta
  title="Private API/Appointments/Form"
  component={AppointmentForm}
  argTypes={{
    form: {table: {disable: true}},
  }}
  parameters={{
    msw: {
      handlers: [
        mockAppointmentProductsGet,
        mockAppointmentLocationsGet,
        mockAppointmentDatesGet,
        mockAppointmentTimesGet,
      ],
    },
  }}
/>

export const Template = ({showProgressIndicator, name}) => {
  const form = buildForm({showProgressIndicator, name, appointmentEnabled: true});
  return <AppointmentForm form={form} />;
};

<Canvas>
  <Story
    name="Default"
    decorators={[ConfigDecorator, LayoutDecorator, RouterDecorator]}
    parameters={{
      docs: {
        source: {
          type: 'dynamic',
          excludeDecorators: true,
        },
      },
    }}
    args={{
      showProgressIndicator: true,
      name: 'Appointment',
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

<ArgsTable of={AppointmentForm} />
