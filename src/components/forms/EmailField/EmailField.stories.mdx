import {Canvas, Meta, Story} from "@storybook/addon-docs";
import {userEvent, within} from "@storybook/testing-library";
import {expect} from '@storybook/jest';
import {FormikDecorator} from "story-utils/decorators";
import EmailField from "./EmailField";
export const Template = (args) => (
  <EmailField {...args} />
);

<Meta
  title="Pure React Components / Forms / EmailField"
  component={EmailField}
  parameters={{
    formik: {
      initialValues: {
        email: 'test'
      },
    }
  }}
/>

<Canvas>
  <Story
    name="Default"
    decorators={[FormikDecorator]}
    play={async ({canvasElement}) => {
      const canvas = within(canvasElement);
      await expect(canvas.getByRole('textbox')).toBeVisible();
      await expect(canvas.getByLabelText('Email')).toBeVisible();
      await expect(canvas.getByText('This is a custom description for the email field')).toBeVisible();
      //Check if clicking on the label focuses the input
      const label = canvas.getByText('Email');
      userEvent.click(label);
      await expect(canvas.getByRole('textbox')).toHaveFocus();
    }}
    args={{
      name: 'email',
      id: 'email',
      label: "Email",
      description: "This is a custom description for the email field",
      disabled: false,
      invalid: false,
      isRequired: true,
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>
